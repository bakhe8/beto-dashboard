const c="beto-state",n=["theme","dir","sidebar"],l=()=>{const t=JSON.parse(localStorage.getItem(c)||"{}");return{theme:"auto",dir:"ltr",sidebar:"default",user:null,cache:{},modal:{open:!1,title:""},toasts:[],...t}};let o=l();const e=new Map,d={get:t=>o[t],set:(t,s)=>{var r;if(o[t]=s,n.includes(t)){const a={};for(const i of n)a[i]=o[i];localStorage.setItem(c,JSON.stringify(a))}(r=e.get(t))==null||r.forEach(a=>a(s))},on:(t,s)=>(e.has(t)||e.set(t,new Set),e.get(t).add(s),()=>{var r;return(r=e.get(t))==null?void 0:r.delete(s)}),_resetForTesting:()=>{o=l(),e.clear()}};export{d as s};
